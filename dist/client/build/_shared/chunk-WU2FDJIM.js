import{a as R,b as k,c as S}from"/build/_shared/chunk-XTVQEJHQ.js";import{e as f,i as m,j as v,l as o,t as g}from"/build/_shared/chunk-LKWFDM4N.js";import{a as T,b as y}from"/build/_shared/chunk-IOELMSQY.js";import{d as h}from"/build/_shared/chunk-2LOM2E4Y.js";var u=h(T()),e=h(y()),b=[{type:"queries",items:[]},{type:"products",items:[]},{type:"collections",items:[]},{type:"pages",items:[]},{type:"articles",items:[]}];function O({searchTerm:s}){let t=(0,u.useRef)(null);return(0,u.useEffect)(()=>{function n(r){r.key==="k"&&r.metaKey&&(r.preventDefault(),t.current?.focus()),r.key==="Escape"&&t.current?.blur()}return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[]),(0,e.jsx)("div",{children:(0,e.jsx)(m,{method:"get",children:(0,e.jsx)("div",{className:"search",children:(0,e.jsx)("input",{defaultValue:s,name:"q",placeholder:"Search\u2026",ref:t,type:"search"})})})})}function G({results:s}){if(!s)return null;let t=Object.keys(s);return(0,e.jsx)("div",{children:s&&t.map(n=>{let r=s[n];if(r.nodes[0]?.__typename==="Page"){let c=r;return r.nodes.length?(0,e.jsx)(E,{pages:c},"pages"):null}if(r.nodes[0]?.__typename==="Product"){let c=r;return r.nodes.length?(0,e.jsx)(q,{products:c},"products"):null}if(r.nodes[0]?.__typename==="Article"){let c=r;return r.nodes.length?(0,e.jsx)(_,{articles:c},"articles"):null}return null})})}function q({products:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{className:"title-search",children:"Produtos"}),(0,e.jsx)(S,{connection:s,children:({nodes:t,isLoading:n,NextLink:r,PreviousLink:c})=>{let i=t.map(a=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/products/${a.handle}`,children:(0,e.jsx)("span",{className:"product-titl",children:a.title})})},a.id));return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c,{children:n?"Loading...":(0,e.jsx)("span",{children:"\u2191 Load previous"})})}),(0,e.jsxs)("div",{children:[i,(0,e.jsx)("br",{})]}),(0,e.jsx)("div",{children:(0,e.jsx)(r,{children:n?"Loading...":(0,e.jsx)("span",{children:"Load more \u2193"})})})]})}}),(0,e.jsx)("br",{})]})}function E({pages:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"P\xE1ginas"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/pages/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function _({articles:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"Artigos"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/blog/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function U(){return(0,e.jsx)("p",{children:"No results, try a different search."})}function M({action:s,children:t,className:n="predictive-search-form",method:r="POST",...c}){let i=f(),a=g(),l=(0,u.useRef)(null);function N(d){let p=s??"/api/predictive-search",P=i.locale?`/${i.locale}${p}`:p,L=d.target.value||"";a.submit({q:L,limit:"6"},{method:r,action:P})}return(0,u.useEffect)(()=>{l?.current?.setAttribute("type","search")},[]),(0,e.jsx)(a.Form,{...c,className:n,onSubmit:d=>{d.preventDefault(),d.stopPropagation(),!(!l?.current||l.current.value==="")&&l.current.blur()},children:t({fetchResults:N,inputRef:l,fetcher:a})})}function V(){let{results:s,totalResults:t,searchInputRef:n,searchTerm:r}=I();function c(i){n.current&&(n.current.blur(),n.current.value="",window.location.href=i.currentTarget.href)}return t?(0,e.jsxs)("div",{className:"predictive-search-results",children:[(0,e.jsx)("div",{children:s.map(({type:i,items:a})=>(0,e.jsx)(C,{goToSearchResult:c,items:a,searchTerm:r,type:i},i))}),r.current&&(0,e.jsx)(o,{onClick:c,to:`/search?q=${r.current}`,children:(0,e.jsxs)("p",{children:["View all results for ",(0,e.jsx)("q",{children:r.current}),"\xA0 \u2192"]})})]}):(0,e.jsx)(A,{searchTerm:r})}function A({searchTerm:s}){return s.current?(0,e.jsxs)("p",{children:["No results found for ",(0,e.jsx)("q",{children:s.current})]}):null}function C({goToSearchResult:s,items:t,searchTerm:n,type:r}){let c=r==="queries",i=`/search?q=${n.current}&type=${w(r)}`;return(0,e.jsxs)("div",{className:"predictive-search-result",children:[(0,e.jsx)(o,{prefetch:"intent",to:i,onClick:s,children:(0,e.jsx)("h5",{children:c?"Sugest\xF5es":r})}),(0,e.jsx)("ul",{children:t.map(a=>(0,e.jsx)(F,{goToSearchResult:s,item:a},a.id))})]},r)}function F({goToSearchResult:s,item:t}){return(0,e.jsx)("li",{className:"predictive-search-result-item",children:(0,e.jsxs)(o,{onClick:s,to:t.url,children:[t.image?.url&&(0,e.jsx)(k,{alt:t.image.altText??"",src:t.image.url,width:50,height:50}),(0,e.jsxs)("div",{children:[t.styledTitle?(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:t.styledTitle}}):(0,e.jsx)("span",{children:t.title}),t?.price&&(0,e.jsx)("small",{children:(0,e.jsx)(R,{data:t.price})})]})]})},t.id)}function I(){let s=v(),t=(0,u.useRef)(""),n=(0,u.useRef)(null),r=s.find(i=>i.data?.searchResults);r?.state==="loading"&&(t.current=r.formData?.get("q")||"");let c=r?.data?.searchResults||{results:b,totalResults:0};return(0,u.useEffect)(()=>{n.current||(n.current=document.querySelector('input[type="search"]'))},[]),{...c,searchInputRef:n,searchTerm:t}}function w(s){let t={articles:"ARTICLE",collections:"COLLECTION",pages:"PAGE",products:"PRODUCT",queries:"QUERY"};return typeof s=="string"?t[s]:s.map(n=>t[n]).join(",")}export{O as a,G as b,U as c,M as d,V as e};

